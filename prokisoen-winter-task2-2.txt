#define _CRT_SECURE_NO_WARNINGS
#include <stdio.h>
#include <stdlib.h>
#include <time.h>
#include <windows.h>

int judge(int[], int[],int n);
void createh(int[], int[],int n);
int nexta(int[], int i,int n);

int main()
{


	//a[0]は1以上しかありえない
	int sum1,sum2,n,index;
	printf("要素数を入力してください:");
	scanf("%d", &n);

	//時間計測用
	clock_t start, end;
	start = clock();

	int *a = (int*)malloc(sizeof(int)*n);
	a[0] = 1;
	for (int k = 1; k < n; k++)a[k] = 0;
	int *h = (int*)malloc(sizeof(int)*n);

	
	//全ての項を足してnになる数字の列を求める
	//h[i]の最大値はn/i つまり半分以降は0か1のみ
	do
	{
		sum1 = 0;
		sum2 = 0;
		index = 1;
		for (int k = 0; k < n; k++)
		{
			h[k] = 0;
			sum1 += a[k];
			sum2 += a[k] * k;
		}
		if (sum1 == n)
		{
			/*printf("{%d", a[0]);
			for (int i = 1; i < n; i++)printf(",%d",a[i]);
			printf("}\n");*/
			if (sum2 == n)
			{
				createh(a, h, n);

				if (judge(a, h, n) == 1)
				{
					printf("{%d", h[0]);
					for (int i = 1; i < n; i++)printf(",%d", h[i]);
					printf("}\n");
				}
			}

			//これ以上a[n-2]を増やしてもsum1>nとなるため桁を上げる
			while (a[index] < (n / index))index++;
			a[index - 1]++;
			for (int k = index; k < n; k++)a[k] = 0;
		}
		a[n - 2]++;
	} while (nexta(a, n-2,n) != 0);

	//時間表示
	end = clock();
	printf("処理時間：%.4f秒\n", (double)(end - start)/(double)CLOCKS_PER_SEC);
	Sleep(100000);
	free(a);
	free(h);
	getchar();
}

int judge(int a[], int h[], int n)
{
	for (int i = 0; i < n; i++)
	{
		if (a[i] != h[i])return 0; //aとhが同じではない時
	}
	return 1; //aとhが同じ時
}

void createh(int a[], int h[], int n)
{
	for (int i = 0; i < n; i++)
	{
		for (int j = 0; j < n; j++)
		{
			if (a[j] == i)h[i]++;
		}
	}
}

//配列aを次のものにする関数(桁上り)
int nexta(int a[], int i, int n)
{
	int sum=0;
	//a[0]がnになり次第終了
	if (a[0] == n)return 0;
	if (i != 0)
	{
		if (n % i == 0)
		{
			if (a[i] >= n / i)
			{
				a[i - 1]++;
				a[i] = 0;
				nexta(a, i - 1,n);
				return 1;
			}
		}
		if (a[i] > (n / i))
		{
			a[i - 1]++;
			a[i] = 0;
			nexta(a, i - 1,n);
			return 1;
		}
	}
}
